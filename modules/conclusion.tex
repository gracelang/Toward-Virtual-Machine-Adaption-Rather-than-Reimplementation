%!TEX root = ../paper.tex

% ---------------------------------------------------------------------------- %
% Outline

\iftoggle{outline}{
    \begin{itemize}
        \item Revisit intro. 
        \item Reconceptualising SOMns as a library for nested OO languages
    \end{itemize}
}{}

\iftoggle{oldcomments}{
	\sm{ok, so, what are the `adaptation mechanisms', the reusable parts you envision so far?
	I would try to give a bit more space to speculating on that, because that's
	likely the part that's most interesting for others.
	%
	Things Truffle doesn't have at the moment is mechanisms to high-level AST manipulation, it doesn't have a notion of lexical scopes, and lexical knowledge.
	Is that something you need for mapping from Grace to SOMns?
	%
	Other aspects missing are libraries for storage strategies for collections (they got them for RPython)
	or things like ropes for strings (immutable tree-like representation, to minimize memory use).
	Libraries of basic math nodes/specializations, assuming that the numeric models
	would be similar between languages (which they are only superficially).
	In terms of standard control structures, it has support for loops.
	Others might be useful, because one typically adds profiling for performance.
	This would make basic steps for language implementers easy.
	%
	Perhaps you have other ideas/aspects you see currently as important.
	}
	\sm{at the moment, I am not sure we fit actually more related work in here.
	Let's not go overboard with the text length.}
}

% 
% ---------------------------------------------------------------------------- %



% ---------------------------------------------------------------------------- %
%

For a fully compliant implementation, we need to address the inheritance model and also differences in lexical scoping between Grace (classes can be nested anywhere) and Newspeak (classes can only be nested inside of other classes). As Truffle does not support higher-level \AST/ manipulation or lexical scoping, we are left with the choice of reimplementing new \AST/ nodes using Truffle (work that requires careful planning) or otherwise changing the SOMns \AST/ nodes (which may conflict with Newspeak semantics).

While language implementation frameworks provide significant advantages, we believe that a set of simple-but-extensible mechanisms for such functionalities as higher-level \AST/ manipulation, lexical scoping, and storage strategies would encourage adaption over reimplementation. Through continuing to adapt SOMns for Grace we pursue the development of such mechanisms. If successful, we can begin to reconceptualize the process of language implementation, where developers may choose to reuse small but valid \vms/ that require only minor adaption to implement semantically correct and fast interpreters for their languages.

%
% ---------------------------------------------------------------------------- %

